# Identifiability Analysis

## 1. Introduction

### 1.1 Problem Background
Traditional Tree-Ring watermarking can only answer a simple question: "Does this image contain a watermark?" (binary classification). However, in real-world commercial scenarios, we need to address a more complex question: "Which vendor generated this image?" (multi-class classification).

### 1.2 Application Scenarios
- **Copyright Tracing**: Identifying the source when infringing images are discovered
- **Multi-Vendor Management**: Cloud service providers need to distinguish content generated by different clients
- **Liability Determination**: Identifying the image generator in legal disputes

### 1.3 Research Objective
This section evaluates RingID's identification capability in multi-key scenarios, verifying whether it can accurately distinguish watermarks from different vendors.

---

## 2. Methodology

### 2.1 RingID Multi-Key Mechanism
RingID achieves multi-key differentiation by injecting different values into different "rings" in the Fourier frequency domain:

- **Watermark Region**: Ring area with radius 3-14 (11 rings total)
- **Key Encoding**: Each ring can take different values; different value combinations represent different keys
- **Theoretical Capacity**: $K^{11}$ distinct keys (where $K$ is the number of values each ring can take)

### 2.2 Experimental Setup

| Parameter | Value |
|-----------|-------|
| Number of Keys | 5 (simulating 5 vendors) |
| Images per Key | 20 |
| Total Images | 100 |
| Image Resolution | 512 × 512 |
| Inference Steps | 50 |
| Prompt Source | Stable-Diffusion-Prompts dataset |

### 2.3 Evaluation Metrics

**Identification Accuracy**:
$$\text{Acc} = \frac{\text{Number of correctly identified images}}{\text{Total number of images}}$$

**Confusion Matrix**:
- Rows: Actual key
- Columns: Predicted key
- Diagonal: Correct identification
- Off-diagonal: Misidentification

---

## 3. Experimental Results

### 3.1 Identification Accuracy

| Attack Type | Accuracy |
|-------------|----------|
| Clean (No Attack) | 100.0% |
| Rotation 75° | 100.0% |
| JPEG Compression 25% | 100.0% |
| Crop & Scale 75% | 86.0% |
| Gaussian Blur (r=8) | 99.0% |
| Gaussian Noise (σ=0.1) | 99.0% |
| Brightness Adjustment | 100.0% |
| **Average** | **97.7%** |

### 3.2 Confusion Matrix

```
              Predicted Key
              K0    K1    K2    K3    K4
Actual K0    [95%,   5%,   0%,   0%,   0%]
       K1    [ 5%,  95%,   0%,   0%,   0%]
       K2    [ 5%,   0%,  95%,   0%,   0%]
       K3    [ 5%,   0%,   0%,  95%,   0%]
       K4    [ 5%,   0%,   0%,   0%,  95%]
```

### 3.3 Confusion Matrix Heatmap

![Confusion Matrix Heatmap](../runs/2026_01_12_22_38_37_multi_key_5vendors/confusion_matrix.png)

---

## 4. Analysis and Discussion

### 4.1 Key Orthogonality Analysis
- Diagonal element ratio: 95% (correct identification rate)
- Off-diagonal element ratio: 5% (misidentification rate)
- Maximum misidentification pair: All Keys → Key 0 (5%)

### 4.2 Attack Robustness Analysis
- **Most Robust**: Clean / Rotation / JPEG / Brightness (accuracy 100%)
- **Most Vulnerable**: Crop & Scale 75% (accuracy 86%)
- **Reason Analysis**: Cropping and scaling destroy the ring structure in the Fourier frequency domain, causing partial watermark information loss

### 4.3 Comparison with Tree-Ring

| Feature | Tree-Ring | RingID |
|---------|-----------|--------|
| Task Type | Binary (watermark/no watermark) | Multi-class (vendor identification) |
| Key Capacity | 1 | $K^{11}$ |
| Identification Accuracy | N/A | 97.7% |

---

## 5. Conclusion

1. RingID can effectively distinguish 5 different vendor keys with an average identification accuracy of **97.7%**
2. Under most attack scenarios, identification accuracy remains above **86%**
3. Keys exhibit good orthogonality with misidentification rate below **5%**
4. RingID addresses the limitation of Tree-Ring's inability to perform multi-vendor identification

---

## Appendix: Experimental Command

```bash
python identify.py \
    --run_name multi_key_5vendors \
    --trials 100 \
    --assigned_keys 5 \
    --reference_model None \
    --save_generated_imgs 1
```
